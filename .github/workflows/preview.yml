name: Expo Preview

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  publish-preview:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ— Depoyu Ã‡ek
        uses: actions/checkout@v4

      - name: ğŸ” DosyalarÄ± Listele (Debug)
        run: ls -la

      - name: ğŸ— Node.js Kurulumu
        uses: actions/setup-node@v4
        with:
          node-version: 18

      - name: ğŸ“¦ EAS CLI YÃ¼kle
        run: npm install -g eas-cli

      - name: ğŸ“¦ BaÄŸÄ±mlÄ±lÄ±klarÄ± YÃ¼kle
        run: npm install

      # ADIM 1: Projeyi Expo ID ile baÅŸlatÄ±yoruz.
      # Bu komut app.json'a ID'yi ekler ve geÃ§erli bir eas.json oluÅŸturur.
      - name: ğŸ”— Projeyi EÅŸleÅŸtir (Link)
        env:
          EXPO_TOKEN: ${{ secrets.EXPO_TOKEN }}
        run: eas init --id 7b7866e2-688e-4e87-af97-88213b2670d4 --non-interactive

      # ADIM 2: GÃ¼ncellemeyi gÃ¶nderiyoruz.
      # ArtÄ±k eas.json hatasÄ± almayacaksÄ±n Ã§Ã¼nkÃ¼ otomatik oluÅŸanÄ± kullanÄ±yoruz.
      - name: ğŸš€ Expo'ya GÃ¶nder (Update)
        env:
          EXPO_TOKEN: ${{ secrets.EXPO_TOKEN }}
        run: eas update --branch preview --message "GitHub Action Update" --non-interactive
